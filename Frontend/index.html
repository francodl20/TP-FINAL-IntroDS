<!DOCTYPE html>
<html>
    <head> 
        <title>Dragon Gacha 4k</title>

        <meta charset="UTF-8">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/grids-responsive-min.css">
        <link rel="stylesheet" href="/css/style.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">

    </head>
    <body>
        <!--Game title-->
        <div class="pure-g" id="pageHeader">
            <h1 class="pure-u-1 center" id="pageTitle"><span class="flame"> Dragon Gacha lesgoo </span></h1>
        </div>
        
        <!--Leaderboard-->
        <div class="pure-g">
            <div class="pure-u-1 center" id="players">

            </div>
        </div>

        <!--Create a player-->
        <div class="pure-g">
            <form action="" onsubmit="create_player(event)" class="pure-u-1 center">
                <input type="text" class="form-control" name="name" id="name"
                placeholder="Jugador123" required>
                <button type="submit" class="pure-button" id="createPlayer">Create Player</button>
            </form>
        </div>


        <script src="JS/leaderboard.js" type="module"></script>
        <script>
            function handle_response(data) {
                if (data.success) {
                    window.location.href = `/player?id=${data.id}`
                } else {
                    alert("Error")
                }
            }

            function create_player(event) {
                event.preventDefault()

                const formData = new FormData(event.target)

                const name = formData.get("name")

                fetch("http://localhost:778/player", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        name: name
                    })
                })
                    .then((res) => res.json())
                    .then(handle_response)
                    .catch((error) => console.log("ERROR", error))
            }
        </script>
    </body>

</html>